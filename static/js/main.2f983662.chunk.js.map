{"version":3,"sources":["compendium.ts","ktlib.ts","roster.tsx","App.js","reportWebVitals.js","index.js"],"names":["next_id","_","undefined","faction","fname","clan_label","kws","units_","_kws","split","units","map","o","name","move","apl","ga","df","sv","hp","extra","keywords","concat","weapons","filter","x","w","uname","replace","type","atk","ws","dam","cdam","sr","cr","secondary","actions","a","cost","descr","abilities","on_weapon","endsWith","id","factions","tau","markerlight","camo_field","space_marine","ork","kombi","orks","Compendium","random_faction","Object","keys","sort","Math","random","storage_get","key","json","localStorage","getItem","JSON","parse","e","storage_get_dflt","dflt","val","storage_set","obj","setItem","stringify","scrub_roster","roster","unit","cunit","find","u","mov2","className","Root","useState","mode","setMode","init","onChange","setVal","nval","useState2","setRoster","onCancel","roster_view","RosterView","onNew","onLoad","create_view","render_if","CreateRoster","onCreate","loader_view","LoadRoster","props","setName","setFaction","clan","setClan","Modal","value","target","style","textTransform","entries","f","onClick","trim","created","Date","updated","disabled","edit","setEdit","add","setAdd","ktlib","fn","editor","onSave","nconf","idx","findIndex","push","doDelete","splice","UnitEditor","conf","saves","save","s","max","n","DataCard","onEdit","DamageTracker","kw","primary","ranged","melee","has_sr","rule","wx","indexOf","count","matchAll","clazz","console","log","each","range_array","i","ceil","join","floor","el1","el2","is_edit","countRef","useRef","rangedRef","meleeRef","unitid","setUnitId","setUnit","setId","length","r_weapons","get_unique_weapons","m_weapons","Select","values","current","children","state","setState","set","Array","from","names","Set","cond","el","App","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","window","location","search","clear","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.2f983662.chunk.js","sourcesContent":["import { Weapon, Faction, Dict } from './types'\n\n\ntype I_Weapon = [0|1,string,number,number,number,number,string?,string?,string?]\ntype I_Ability = [2,string,string?]\ntype I_Action = [3,string,number,string]\ntype I_Extra = I_Weapon | I_Ability | I_Action\ntype I_Unit = [string,number,number,number,number,number,number,string,...I_Extra[]]\n\n\nlet next_id = 1;\nconst _ = undefined;\n\nfunction faction(fname:string, faction:string, clan_label:string, kws:string, units_:I_Unit[])\n  : Faction\n{\n  var _kws = kws.split(/, /g);\n\n  let units = units_.map(o => {\n    const [name,move,apl,ga,df,sv,hp,kws,...extra] = o;\n\n    var keywords = _kws.concat(kws.split(/, /g));\n\n    var weapons = (extra.filter(x => x[0] === 0 || x[0] === 1) as I_Weapon[]).map(w => {\n      var uname = w[1].replace(/ \\|.*$/,'')\n      return {\n        name:w[1], uname, type: (!w[0] ? 'r' : 'm'), atk:w[2], ws:w[3], dam:w[4], cdam:w[5],\n        sr: w[6] || null, cr: w[7] || null, secondary:w[8] || null\n      } as Weapon\n    });\n\n    var actions = (extra.filter(x => x[0] === 3) as I_Action[])\n      .map(a => ({ name: a[1], cost: a[2], descr: a[3] }));\n\n    var abilities = (extra.filter(x => x[0] === 2) as I_Ability[])\n      .map(a => ({name: a[1], descr: a[2] || \"\", on_weapon:a[1].endsWith('*')}));\n\n    var id = next_id++;\n    return {id,name,faction,keywords,move,apl,ga,df,sv,hp,weapons,actions,abilities};\n  });\n\n  return {\n    name: fname,\n    clan_label, units,\n  }\n}\n\n\nfunction tau() {\n  var markerlight:I_Action = [3, 'Markerlight', 1, 'See page 137'];\n  var camo_field:I_Ability = [2, 'Camouflage Field', 'Each time an enemy operative makes a shooting attack, unless it is within @0 of this operative or it is a subsequent attack made as a result of the Blast special rule, this operative is always treated as being in Cover for that shooting attack. While this operative has a Conceal order, it is always treated as having a Conceal order, regardless of any other rules (e.g. Vantage Point).']\n\n  return faction(\"T'au Empire\", 'hunter cadre', 'sept', \"t'au, <>\", [\n    [\n      \"Fire warrior shas'la\", 3, 2, 1, 3, 4, 7, \"fire warrior, shas'la\",\n      [0, \"Pulse blaster | Close range\", 4, 4, 4, 5, 'Rng @6, AP1'],\n      [0, \"Pulse blaster | Long range\", 4, 4, 3, 4],\n      [0, \"Pulse carbine\", 4, 4, 4, 5],\n      [0, \"Pulse rifle\", 4, 4, 4, 5],\n      [1, \"Gun butt\", 3, 5, 2, 3],\n      markerlight, camo_field\n    ],[\n      \"Fire warrior shas'ui\", 3, 2, 1, 3, 4, 8, \"leader, fire warrior, shas'ui\",\n      [0, \"Pulse blaster | Close range\", 4, 3, 4, 5, 'Rng @6, AP1'],\n      [0, \"Pulse blaster | Long range\", 4, 3, 3, 4],\n      [0, \"Pulse carbine\", 4, 3, 4, 5],\n      [0, \"Pulse rifle\", 4, 3, 4, 5],\n      [1, \"Gun butt\", 3, 5, 2, 3]\n    ],[\n      \"Pathfinder shas'la\", 3, 2, 1, 3, 5, 7, \"pathfinder, shas'la\",\n      [0, 'Pulse carbine', 4, 4, 4, 5],\n      [1, 'Gun butt', 3, 5, 2, 3],\n    ],[\n      \"Pathfinder (heavy gunner)\", 3, 2, 1, 3, 5, 7, \"pathfinder, heavy gunner\",\n      [0, 'Ion rifle | Standard', 5, 4, 4, 5, '', 'P1'],\n      [0, 'Ion rifle | Overcharge', 5, 4, 5, 6, 'AP1, Hot'],\n      [0, 'Rail Rifle', 4, 4, 4, 4, 'AP1, Lethal 5+', 'MW2'],\n      [1, 'Gun butt', 3, 5, 2, 3]\n    ],[\n      \"Pathfinder shas'ui\", 3, 2, 1, 3, 5, 8, \"leader, pathfinder, shas'ui\",\n      [0, 'Pulse carbine', 4, 3, 4, 5],\n      [1, 'Gun butt', 3, 5, 2, 3],\n      markerlight\n    ],[\n      \"Stealth battlesuit shas'ui\", 3, 2, 1, 3, 3, 10, \"fly, stealth battlesuit, shas'ui\",\n      [0, 'Burst cannon', 6, 4, 3, 4, 'Ceaseless, Fusillade'],\n      [0, 'Fusion blaster', 4, 4, 6, 3, 'Rng @6, AP2', 'MW4'],\n      [1, 'Fists', 4, 5, 2, 3],\n      camo_field\n    ],[\n      \"Stealth battlesuit shas'vre\", 3, 2, 1, 3, 3, 11, \"fly, leader, stealth battlesuit, shas'vre\",\n      [0, 'Burst cannon', 6, 3, 3, 4, 'Ceaseless, Fusillade'],\n      [0, 'Fusion blaster', 4, 4, 6, 3, 'Rng @6, AP2', 'MW4'],\n      [1, 'Fists', 4, 4, 2, 3],\n      camo_field\n    ]\n  ]);\n}\n\nfunction space_marine() {\n  return faction('Space Marines', 'space marine', 'chapter', 'imperium, adeptus astartes, <>', [\n    [\n      'Intercessor (warrior)', 3, 3, 1, 3, 3, 13, 'primaris, intercessor, warrior',\n      [0, 'Auto bolt rifle', 4, 3, 3, 4, 'Ceaseless'],\n      [0, 'Bolt rifle', 4, 3, 3, 4, _, 'P1'],\n      [0, 'Stalker bolt rifle', 4, 3, 3, 4, 'Heavy, AP1'],\n      [1, 'Fists', 4, 3, 3, 4]\n    ],[\n      'Intercessor sergeant', 3, 3, 1, 3, 3, 14, 'primaris, leader, intercessor, sergeant',\n      [0, 'Auto bolt rifle', 4, 2, 3, 4, 'Ceaseless'],\n      [0, 'Bolt pistol', 4, 2, 3, 4, 'Rng @6'],\n      [0, 'Bolt rifle', 4, 2, 3, 4, '', 'P1'],\n      [0, 'Hand flamer', 4, 2, 2, 2, 'Rng @6, Torrent @1'],\n      [0, 'Plasma Pistol | Standard', 4, 2, 5, 6, 'Rng @6, AP1'],\n      [0, 'Plasma Pistol | Supercharge', 4, 2, 5, 6, 'Rng @6, AP2, Hot'],\n      [0, 'Stalker bolt rifle', 4, 2, 3, 4, 'Heavy, A:1'],\n      [1, 'Chainsword', 4, 3, 4, 5],\n      [1, 'Fists', 4, 3, 3, 4],\n      [1, 'Power fist', 4, 4, 5, 7, 'Brutal'],\n      [1, 'Power weapon', 4, 3, 4, 6, 'Lethal 5+'],\n      [1, 'Thunder hammer', 4, 4, 5, 6, '', 'Stun'],\n    ]\n  ]);\n}\n\nfunction orks() {\n  let kombi:I_Ability = [2, 'Kombi*',\n    'An operative equipped with this weapon is also equipped with a shoota.']\n  let runt:I_Ability = [2, 'Runt',\n    'This operative cannot be equipped with equipment. This operative cannot benefit from your Strategic and Tactical Ploys.'];\n\n  return faction('Orks', 'greenskin', 'clan', 'ork, <>', [\n    [\n      'Boy (fighter)', 3, 2, 1, 3, 5, 10, 'boy, fighter',\n      [0, 'Shoota', 4, 5, 3, 4],\n      [0, 'Slugga', 4, 5, 3, 4, 'Rng @6'],\n      [1, 'Choppa', 4, 3, 4, 5],\n      [1, 'Fists', 3, 3, 3, 4],\n    ],[\n      'Boss Nob', 3, 2, 1, 3, 4, 13, 'leader, boy, boss nob',\n      [0, 'Kombi-rokkit', 5, 5, 4, 5, 'Kombi*, Limited, AP1', 'Splash 1'],\n      [0, 'Kombi-skorcha', 6, 2, 2, 2, 'Kombi*, Limtied, Rng @6, Torrent @1'],\n      [0, 'Shoota', 4, 5, 3, 4, _, _, kombi[1]],\n      [0, 'Slugga', 4, 5, 3, 4, 'Rng @6'],\n      [1, 'Big choppa', 4, 2, 5, 6],\n      [1, 'Choppa', 4, 2, 4, 5],\n      [1, 'Fists', 3, 2, 3, 4],\n      [1, 'Killsaw', 4, 3, 5, 7, _, 'Rending'],\n      [1, 'Power klaw', 4, 3, 5, 7, 'Brutal'],\n      kombi,\n    ],[\n      'Boy (gunner)', 3, 2, 1, 3, 5, 10, 'boy, gunner',\n      [0, 'Big shoota', 6, 5, 2, 3, 'Fusillade'],\n      [0, 'Rokkit launcha', 5, 5, 4, 5, 'AP1', 'Splash 1'],\n      [1, 'Fists', 3, 3, 3, 4],\n    ],[\n      'Gretchin', 3, 2, 2, 3, 6, 5, 'boy, gretchin',\n      [0, 'Gretchin blasta', 3, 4, 2, 3, 'Rng @6'],\n      [1, 'Gretchin knife', 3, 5, 1, 2],\n      runt,\n    ],[\n      'Clan kommando (fighter)', 3, 2, 1, 3, 5, 10, 'clan kommando, fighter',\n      [0, 'Slugga', 4, 5, 3, 4, 'Rng @6'],\n      [1, 'Choppa', 4, 3, 4, 5],\n    ],[\n      'Clan kommando nob', 3, 2, 1, 3, 4, 13, 'leader, clan kommando, kommando nob',\n      [0, 'Slugga', 4, 4, 3, 4, 'Rng @6'],\n      [1, 'Choppa', 4, 2, 4, 5],\n      [1, 'Power klaw', 4, 3, 5, 7, 'Brutal'],\n    ],[\n      'Burna boy', 3, 2, 1, 3, 5, 10, 'speshulist, burna boy',\n      [0, 'Burna', 5, 2, 2, 2, 'Rng @6, Torrent @1'],\n      [1, 'Fists', 3, 3, 3, 4],\n    ],[\n      'Loota', 3, 2, 1, 3, 5, 10, 'speshulist, loota',\n      [0, 'Deffgun', 5, 5, 4, 6],\n      [1, 'Fists', 3, 3, 3, 4],\n    ],[\n      'Spanner', 3, 2, 1, 3, 5, 11, 'leader, speshulist, spanner',\n      [0, 'Big shoota', 6, 4, 2, 3, 'Fusillade'],\n      [0, 'Kustom mega-blasta', 4, 4, 5, 6, 'AP2, Hot'],\n      [0, 'Rokkit launcha', 5, 4, 4, 5, 'AP1', 'Splash 1'],\n      [1, 'Fists', 3, 3, 3, 4],\n    ]\n  ]);\n}\n\n\n\nconst factions:Dict<Faction> = {\n  tau: tau(),\n  space_marine: space_marine(),\n  ork: orks(),\n}\n\nfunction random_faction() {\n  return Object.keys(factions).sort(() => Math.random()-.5)[0];\n}\n\nexport const Compendium = {factions, random_faction}\n\n\n","import {Roster} from './types'\nimport {Compendium} from './compendium'\n\n\ntype Save = {id:number, name:string, faction:string}\ntype Saves = Save[]\n\n\nfunction storage_get<T>(key:string) : T|null {\n  key = `kt_${key}`\n  try {\n    let json = localStorage.getItem(key)\n    if (json) {\n      return JSON.parse(json) as T\n    }\n  } catch (e) {}\n  return null;\n}\n\nfunction storage_get_dflt<T>(key:string, dflt:T) : T {\n  let val = storage_get<T>(key);\n  if (val) {\n    return val;\n  } else {\n    storage_set(key,dflt)\n    return dflt;\n  }\n}\n\nfunction storage_set<T>(key:string, obj:T) {\n  key = `kt_${key}`\n  localStorage.setItem(key, JSON.stringify(obj));\n}\n\n\nfunction scrub_roster(roster:Roster|null) {\n  if (roster) {\n    const units = Compendium.factions[roster.faction].units\n\n    for (let unit of roster.units) {\n      const cunit = units.find(u => (u.name === unit.unit.name));\n      if (cunit)  unit.unit = cunit;\n    }\n  }\n\n  return roster\n}\n\n\nexport function autosave(roster:Roster) {\n  roster.updated = new Date()\n  storage_set('autosave', roster);\n}\n\nexport function load_autosave() : Roster|null {\n  return scrub_roster(storage_get<Roster>('autosave'))\n}\n\nexport function save(roster:Roster) {\n  var saves = storage_get_dflt('saves', [] as Saves)\n  var save = saves.find(s => (s.name === roster.name && s.faction === roster.faction));\n\n  // create a new save\n  if (!save) {\n    var id = Math.max(0, ...saves.map(s => s.id)) + 1;\n    save = {id:id, name:roster.name, faction:roster.faction};\n    saves.push(save);\n    storage_set('saves',saves);\n  }\n\n  // write the save\n  storage_set(`save_${save?.id}`, roster);\n}\n\nexport function get_saves() : Saves {\n  return storage_get_dflt('saves', [] as Saves)\n}\n\nexport function load(id:number) : Roster|null {\n  return scrub_roster(storage_get<Roster>(`save_${id}`));\n}\n\n\n","import {Unit,UnitConf,Weapon,Roster} from './types'\nimport {Compendium} from './compendium'\nimport {useState,useRef} from 'react'\nimport * as ktlib from './ktlib'\n\n\nconst mov1 = (<span className=\"ktg-m1\" />)\nconst mov2 = (<span className=\"ktg-m2\" />)\nconst mov3 = (<span className=\"ktg-m4\" />)\nconst mov6 = (<span className=\"ktg-m6\" />)\n\n\n\nfunction useState2<T>(init:T, onChange: (_:T) => void) : [T,(_:T) => void] {\n  const [val,setVal] = useState(init);\n  const setVal2 = (nval:T) => {\n    setVal(nval);\n    onChange(nval);\n  }\n\n  return [val,setVal2]\n}\n\n\nexport function Root() {\n  const [mode,setMode] = useState(0)\n  const [roster,setRoster] = useState2(ktlib.load_autosave(), () => setMode(0));\n\n  const onCancel = () => setMode(0);\n\n  let roster_view = <></>\n  if (roster) {\n    roster_view = (<RosterView roster={roster} onNew={() => setMode(1)} onLoad={() => setMode(2)}/>)\n  }\n  let create_view = render_if(!roster || mode === 1,\n    (<CreateRoster onCreate={setRoster} onCancel={onCancel} />))\n  let loader_view = render_if(mode === 2,\n    (<LoadRoster onLoad={setRoster} onCancel={onCancel} />))\n\n  return <>{roster_view}{create_view}{loader_view}</>\n}\n\n\nexport function CreateRoster(props:{\n  onCreate(roster:Roster): void,\n  onCancel?: () => void\n}) {\n  const [name,setName] = useState('')\n  const [faction,setFaction] = useState(() => Compendium.random_faction())\n  const [clan,setClan] = useState('')\n\n  const {clan_label} = Compendium.factions[faction]\n\n  const create = () => {\n    props.onCreate({\n      name: name.trim(),\n      faction: faction.trim(),\n      clan: clan.trim(),\n      units: [],\n      created: new Date(),\n      updated: new Date(),\n    })\n  }\n\n  return <Modal><div className=\"kt-create\">\n    <div>Name:</div><div><input value={name} onChange={e => setName(e.target.value)} /></div>\n    <div style={{textTransform:'capitalize'}}>{clan_label}:</div>\n    <div><input value={clan} onChange={e => setClan(e.target.value)} /></div>\n    <div>Faction:</div><div><select value={faction} onChange={e => setFaction(e.target.value)}>\n      {Object.entries(Compendium.factions).map(([id,f]) => (\n            <option key={id} value={id}>{f.name}</option>\n      ))}\n    </select></div>\n    <div className=\"buttons\">\n      {render_if(!!props.onCancel, (<button onClick={props.onCancel}>Cancel</button>))}\n      <button onClick={create} disabled={!name.trim() || !clan.trim()}>Create</button>\n    </div>\n  </div></Modal>\n}\n\n\nexport function RosterView(props:{\n  roster:Roster,\n  onNew() : void,\n  onLoad() : void,\n}) {\n  const [edit,setEdit] = useState<UnitConf|null>(null)\n  const [add,setAdd] = useState(false)\n\n  const roster = props.roster;\n  const units = roster.units;\n  ktlib.autosave(roster);\n  const faction = Compendium.factions[roster.faction]\n\n  // setup the editor\n  let editor = render_iff(!!edit || add, () => {\n\n    const onSave = (nconf:UnitConf) => {\n      setEdit(null)\n      setAdd(false)\n\n      const idx = units.findIndex(u => (u === edit));\n      if (idx === -1) {\n        units.push(nconf)\n      } else {\n        units[idx] = nconf;\n      }\n    }\n\n    const onCancel = (doDelete:boolean) => {\n      setEdit(null)\n      setAdd(false)\n\n      if (doDelete) {\n        const idx = units.findIndex(u => (u === edit));\n        if (idx !== -1) {\n          units.splice(idx,1);\n        }\n      }\n    }\n\n    if (edit) {\n      return (<UnitEditor onSave={onSave} onCancel={onCancel} faction={roster.faction} conf={edit} />)\n    } else {\n      return (<UnitEditor onSave={onSave} onCancel={onCancel} faction={roster.faction} />)\n    }\n  })\n\n  // render\n  return <div>\n    {editor}\n\n    <div className=\"kt-controls\">\n      <button onClick={props.onNew}>New</button>\n      <button onClick={() => ktlib.save(roster)}>Save</button>\n      <button onClick={props.onLoad}>Load</button>\n      <button onClick={() => setAdd(true)}>Add Operative</button>\n    </div>\n\n    <div className=\"kt-roster\">\n      <div className=\"header\">\n        <b>Name</b> {roster.name}<br/>\n        <b>Faction</b> {faction.name}<br/>\n        <b>{faction.clan_label}</b> {roster.clan}\n      </div>\n      <div className=\"body\">\n        <div>{units.map((u,n) => (<DataCard clan={roster.clan} key={n} conf={u} onEdit={() => setEdit(u)} />))}</div>\n        <DamageTracker units={units} />\n      </div>\n    </div>\n  </div>\n}\n\n\nfunction DataCard(props:{\n  conf:UnitConf,\n  clan:string,\n  onEdit(): void,\n}) {\n  const conf = props.conf;\n  const unit = conf.unit;\n  var keywords = unit.keywords.map(kw => (kw === '<>') ? `, ${props.clan}` : `, ${kw}`)\n  var primary = unit.weapons.filter(w => (w.uname === conf.ranged || w.uname === conf.melee));\n  const has_sr = (rule:string) => !!primary.find(wx => wx.sr && (wx.sr.indexOf(rule) !== -1));\n\n  // check if secondary weapons should be enabled\n  var weapons = unit.weapons.filter(w => {\n    return ((w.secondary !== null) && has_sr(w.secondary))\n        || (w.uname === conf.ranged || w.uname === conf.melee);\n  });\n\n  // check if any of the abilities are based upon the weapons\n  var abilities = unit.abilities.filter(a => {\n    return !a.on_weapon || has_sr(a.name);\n  });\n\n  // replace special rules\n  return (\n    <div className=\"kt-unit-info\">\n      <button className=\"edit\" onClick={props.onEdit}>EDIT</button>\n      <div className=\"name\">{conf.count ? `( ${conf.count} ) ` : ''}&nbsp;{unit.name}</div>\n      <div className=\"keywords\"><b>{unit.faction}</b>{keywords}</div>\n      <div className=\"info\">\n        <div className=\"stats topline\"><b>M</b> {unit.move}{mov2} <b>APL</b> {unit.apl} <b>GA</b> {unit.ga} <b>DF</b> {unit.df} <b>SV</b> {unit.sv}+ <b>W</b> {unit.hp}</div>\n\n        {weapons.map((w,n) => (<div key={n} className=\"weapon\">\n          <div className=\"wname\"><div className={w.type} />{w.name} &nbsp;&nbsp;</div>\n          <div className=\"stats \">\n            <b>A</b> {w.atk} <b>{w.type === 'r' ? 'BS' : 'WS'}</b> {w.ws}+ <b>D</b> {w.dam}/{w.cdam}\n            <br/>\n            {!w.sr ? null : (<><b>SR</b> </>)}\n            {[...(w.sr||\"\").matchAll(/([^@]+|@.)/g)].map(([x]) => {\n              if (x[0] === '@') {\n                let clazz= `ktg-m${x[1]}`\n                console.log(clazz)\n                return (<span className={clazz} />)\n              } else {\n                return (<span>{x}</span>)\n              }\n            })}\n            {!w.cr ? null : (<><b>!</b> {w.cr} </>)}\n          </div>\n        </div>))}\n\n        {unit.actions.map((a,n) => (<div key={n} className=\"extra\">\n          <div className=\"i-action\" />\n          <span>{a.name} - {a.cost} AP</span><span className=\"descr\"> - {a.descr}</span>\n        </div>))}\n\n        {abilities.map((a,n) => (<div key={n} className=\"extra\">\n          <div className=\"i-ability\" />\n          <span>{a.name}</span><span className=\"descr\"> - {a.descr}</span>\n        </div>))}\n      </div>\n    </div>\n  )\n}\n\nfunction DamageTracker({units}:{units:UnitConf[]}) {\n  var n = 0;\n  var each = units.map(({unit,count}) => (<div key={n++} className=\"unit\">\n    <div className=\"name\">{unit.name}</div>\n    {range_array(count).map(i => (<div className=\"pips\" key={n++}>\n      {range_array(Math.ceil(unit.hp/2)).map(() => 'O').join('')}&nbsp;&nbsp;\n      {range_array(Math.floor(unit.hp/2)).map(() => 'O').join('')}\n    </div>))}\n  </div>));\n\n  return <div className=\"kt-dam-track\">{each}</div>\n}\n\n\nfunction UnitEditor(props:{\n  conf?: UnitConf,\n  onSave(_:UnitConf): void,\n  onCancel(_:boolean): void,\n  faction: string,\n}) {\n  const conf = props.conf;\n  const is_edit = !!conf;\n  const countRef = useRef(conf ? `${conf.count}`: '0')\n  const rangedRef = useRef(conf ? conf.ranged : '')\n  const meleeRef = useRef(conf ? conf.melee : '')\n\n  const [unitid,setUnitId] = useState<number>(0)\n  const [unit,setUnit] = useState(conf?.unit)\n\n  const onSave = () => {\n    props.onSave({\n      count: ~~countRef.current,\n      ranged: rangedRef.current,\n      melee: meleeRef.current,\n      unit: unit as Unit\n    })\n  }\n\n  // setup the add unit portion\n  var el1:any\n  if (!conf) {\n    let {units} = Compendium.factions[props.faction];\n\n    const setId = (id:number) => {\n      setUnitId(id)\n      setUnit(units.find(u => u.id === id))\n    }\n\n    // default the unit selection\n    if (units.length && !units.find(u => (u.id === unitid))) {\n      setId(units[0].id)\n    }\n\n    el1 = (<>\n      {!units.length ? null : (<><div>Unit:</div><div>\n        <select value={unitid} onChange={e => setId(~~e.target.value)}>\n          {units.map(u => (<option key={u.id} value={u.id}>{u.name}</option>))}\n        </select>\n      </div></>)}\n    </>)\n  }\n\n  // setup the configuration part\n  var el2:any;\n  if (unit) {\n    const weapons = unit.weapons.filter(w => !w.secondary);\n    const r_weapons = get_unique_weapons('r',weapons);\n    const m_weapons = get_unique_weapons('m',weapons);\n\n    el2 = (<>\n      <div>Count:</div><div>\n        <Select value={countRef} values={range_array(10).map(n => `${n+1}`)} />\n      </div>\n      <div>Ranged:</div><div>\n        <Select value={rangedRef} values={r_weapons} />\n      </div>\n      <div>Melee:</div><div>\n        <Select value={meleeRef} values={m_weapons} />\n      </div>\n    </>)\n  }\n\n  return (<Modal><div className=\"kt-unit-editor\">\n    {el1}{el2}\n    <div className=\"buttons\">\n      <button onClick={() => props.onCancel(false)}>Cancel</button>\n      {render_if(is_edit, (<button onClick={() => props.onCancel(true)}>Delete</button>))}\n      <button onClick={() => onSave()}>{is_edit ? 'Save' : 'Add'}</button>\n    </div>\n  </div></Modal>);\n}\n\n\nfunction LoadRoster(props:{\n  onLoad(roster:Roster) : void,\n  onCancel() : void\n}) {\n  let saves = ktlib.get_saves()\n\n  const onLoad = (id:number) => {\n    let roster = ktlib.load(id)\n    if (roster)  props.onLoad(roster)\n  }\n\n  return <Modal><div className=\"kt-loader\">\n    {saves.map(s => (<button onClick={() => onLoad(s.id)}>\n        {s.name} | {Compendium.factions[s.faction].name}\n    </button>))}\n    <button onClick={props.onCancel}>Cancel</button>\n  </div></Modal>\n}\n\n\nfunction Modal({children}:{children:any}) {\n  return (<div className=\"kt-modal\"><div className=\"inner\">{children}</div></div>)\n}\n\n\nfunction Select({values,value}:{\n  values: string[],\n  value: React.MutableRefObject<string>,\n\n\n}) {\n  const [state,setState] = useState(value.current)\n\n  if (!values.find(x => (x===state))) {\n    set(values[0]);\n  }\n\n  function set(nval:string) {\n    value.current = nval;\n    setState(nval)\n  }\n\n  return (<select value={state} onChange={e => set(e.target.value)}>\n    {values.map(n => (<option key={n}>{n}</option>))}\n  </select>)\n}\n\n\n\n// ---- helper functions\nfunction range_array(n:number) {\n  return Array.from(Array(n).keys());\n}\n\nfunction get_unique_weapons(type:'r'|'m', weapons:Weapon[]) {\n  let names = weapons.filter(w => w.type === type).map(w => w.uname)\n  return [...new Set(names)]\n}\n\ntype RenderFn = () => JSX.Element;\n\nfunction render_if(cond:boolean, el:JSX.Element) : JSX.Element|null {\n  return cond ? el : null;\n}\n\nfunction render_iff(cond:boolean, fn:RenderFn) : JSX.Element|null {\n  return cond ? fn() : null;\n}\n","import './bob.scss';\nimport {Root} from './roster';\n\nfunction App() {\n  return (\n    <Root />\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\n// reset the local storage state\nif (window.location.search.indexOf('reset') !== -1) {\n  localStorage.clear()\n  window.location.replace('/')\n\n// normal\n} else {\n  ReactDOM.render(\n    <React.StrictMode>\n      <App />\n    </React.StrictMode>,\n    document.getElementById('root')\n  );\n\n  // If you want to start measuring performance in your app, pass a function\n  // to log results (for example: reportWebVitals(console.log))\n  // or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\n  reportWebVitals();\n}\n"],"sourceRoot":""}